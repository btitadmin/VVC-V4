<!DOCTYPE html>
<html>
    <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script defer src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <script src="https://unpkg.com/scrollreveal"></script>
    <script src="https://code.jquery.com/jquery-3.5.1.js"></script>
    <link href="https://cdn.datatables.net/v/dt/dt-2.1.8/datatables.min.css" rel="stylesheet">
    <script src="https://cdn.datatables.net/v/dt/dt-2.1.8/datatables.min.js"></script>
  
    <script src="https://cdn.datatables.net/2.1.8/js/dataTables.js"></script>

    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css"
    />
    
        <link rel="stylesheet" href="style1.css">
        <!-- <script type="module" src="./homepage.js"></script> -->
  </head>
  <body>
    <!-- navbar -->
     <div class="bg-color"></div>
    <nav class="navbar navbar-expand-lg">
      <div class="container-fluid">
        <a class="navbar-brand logo"><img src="https://i.ibb.co/HTksMQd/Logo-Van-Van-2.png" alt=""></a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse justify-content-end menu" id="navbarNavDropdown">
          <ul class="navbar-nav">
            <li class="nav-item">
              <a class="nav-link active" aria-current="page" href="index2.html">ទំព័រដើម</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="index3.html">របាយការណ៍ប្រជុំ</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#"></a>
            </li>
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                ឯកសារផ្សេងៗ
              </a>
              <ul class="dropdown-menu">
                <li><a class="dropdown-item" href="#">ពាក្យស្នើរសុំ</a></li>
                <li><a class="dropdown-item" href="#">ឯកសារសម្រាប់ Print</a></li>
                <li><a class="dropdown-item" href="#">លិខិតបញ្ជាបេសសកម្ម</a></li>
              </ul>
            </li>
          </ul>
        </div>
    </nav>
    <div class="data-view">
      <iframe src="https://script.google.com/macros/s/AKfycby1__PFoLmqGir1UuX7lJPj0yp04TdRfxnHnTMdFWCSSpG3UHt4o4TPeqfDSi8UlOGT/exec" frameborder="0" width="100%" height="100%"></iframe>
    </div>
    <script>
      const scrollRevealOption = {
    origin: "bottom",
    distance: "10px",
    duration: 1000,
  };
  
  ScrollReveal().reveal(".navbar", {
    ...scrollRevealOption,
    origin: "bottom",
  });
  ScrollReveal().reveal(".text-main", {
    ...scrollRevealOption,
    delay: 400,
  });
  ScrollReveal().reveal(".boks", {
    ...scrollRevealOption,
    delay: 500,
  });
  ScrollReveal().reveal(".f-boks", {
    ...scrollRevealOption,
    delay: 700,
  });
  function checkbox() {
      const checkbox = document.getElementById("checkbox1");
      checkbox.checked = true; // Set the checkbox to checked
    }
    fetch(
          "https://script.google.com/macros/s/AKfycbxdxh_lugXVJnN9w4X3KTpMrA8B1lJX5qFDdBGBLC1tjAusRkHdQNXFDG4dJCHanCRZ-w/exec",
          {
            redirect: "follow",
            method: "POST",
            body: formDataString,
            headers: {
              "Content-Type": "text/plain;charset=utf-8",
            },
          }
        )
    /*
# CREATED BY: BPWEBS.COM
# URL: https://www.bpwebs.com
*/

function doGet() {
  return HtmlService.createTemplateFromFile('Index').evaluate();
}

//GET DATA FROM GOOGLE SHEET AND RETURN AS AN ARRAY
function getData() {
  var spreadSheetId = "1G0qrkwWOisX4q6BIb_Vm3KMItEXMuyyI-gPDxslyr8Q"; //CHANGE
  var dataRange = "db_form!A2:AD"; //CHANGE

  var range = Sheets.Spreadsheets.Values.get(spreadSheetId, dataRange);
  var values = range.values;

  return values;
}

//INCLUDE JAVASCRIPT AND CSS FILES
//REF: https://developers.google.com/apps-script/guides/html/best-practices#separate_html_css_and_javascript

function include(filename) {
  return HtmlService.createHtmlOutputFromFile(filename)
    .getContent();
}

  google.script.run.withSuccessHandler(showData).getData();

  //THIS FUNCTION GENERATE THE DATA TABLE FROM THE DATA ARRAY
  function showData(dataArray){
    $(document).ready(function(){
      $('#data-table').DataTable({
        data: dataArray,
        //CHANGE THE TABLE HEADINGS BELOW TO MATCH WITH YOUR SELECTED DATA RANGE
        columns: [
          {"title":"ថ្ងៃខែឆ្នាំឈប់"},
          {"title":"ឈ្មោះអ្នកសើ្នសុំ"},
          {"title":"ចំនួនថ្ងៃ"},
          {"title":"មុខតំណែង"},
        ]
      });
    });
  }
    </script>
  </body>
</html>
